!function(context){function Lazy(source){if(source instanceof Array)return new ArrayWrapper(source);if("string"==typeof source)return new StringWrapper(source);if(source instanceof Sequence)return source;if(Lazy.extensions){for(var result,extensions=Lazy.extensions,length=extensions.length;!result&&length--;)result=extensions[length](source);if(result)return result}return new ObjectWrapper(source)}function Sequence(){}function Iterator(sequence){this.sequence=sequence,this.index=-1}function MemoizedSequence(parent){this.parent=parent}function MappedSequence(parent,mapFn){this.parent=parent,this.mapFn=mapFn}function MappingIterator(sequence,mapFn){this.iterator=sequence.getIterator(),this.mapFn=mapFn,this.index=-1}function FilteredSequence(parent,filterFn){this.parent=parent,this.filterFn=filterFn}function FilteringIterator(sequence,filterFn){this.iterator=sequence.getIterator(),this.filterFn=filterFn,this.index=0}function ReversedSequence(parent){this.parent=parent}function ReversedIterator(sequence){this.sequence=sequence}function ConcatenatedSequence(parent,arrays){this.parent=parent,this.arrays=arrays}function TakeSequence(parent,count){this.parent=parent,this.count=count}function TakeIterator(sequence,count){this.iterator=sequence.getIterator(),this.count=count}function TakeWhileSequence(parent,predicate){this.parent=parent,this.predicate=predicate}function DropSequence(parent,count){this.parent=parent,this.count="number"==typeof count?count:1}function DropWhileSequence(parent,predicate){this.parent=parent,this.predicate=predicate}function SortedSequence(parent,sortFn){this.parent=parent,this.sortFn=sortFn}function GroupedSequence(parent,keyFn){this.parent=parent,this.keyFn=keyFn}function CountedSequence(parent,keyFn){this.parent=parent,this.keyFn=keyFn}function UniqueSequence(parent,keyFn){this.parent=parent,this.keyFn=keyFn}function ZippedSequence(parent,arrays){this.parent=parent,this.arrays=arrays}function ShuffledSequence(parent){this.parent=parent}function FlattenedSequence(parent){this.parent=parent}function WithoutSequence(parent,values){this.parent=parent,this.values=values}function IntersectionSequence(parent,arrays){this.parent=parent,this.arrays=arrays}function UniqueMemoizer(iterator){this.iterator=iterator,this.set=new Set,this.memo=[],this.currentValue=void 0}function ChunkedSequence(parent,size){this.parent=parent,this.chunkSize=size}function ChunkedIterator(sequence,size){this.iterator=sequence.getIterator(),this.size=size}function TappedSequence(parent,callback){this.parent=parent,this.callback=callback}function SimpleIntersectionSequence(parent,array){this.parent=parent,this.array=array,this.each=getEachForIntersection(array)}function getEachForIntersection(source){return source.length<40?SimpleIntersectionSequence.prototype.eachArrayCache:SimpleIntersectionSequence.prototype.eachMemoizerCache}function SimpleZippedSequence(parent,array){this.parent=parent,this.array=array}function ArrayLikeSequence(){}function IndexedIterator(sequence){this.sequence=sequence,this.index=-1}function IndexedMappedSequence(parent,mapFn){this.parent=parent,this.mapFn=mapFn}function IndexedFilteredSequence(parent,filterFn){this.parent=parent,this.filterFn=filterFn}function IndexedReversedSequence(parent){this.parent=parent}function IndexedTakeSequence(parent,count){this.parent=parent,this.count=count}function IndexedDropSequence(parent,count){this.parent=parent,this.count="number"==typeof count?count:1}function IndexedConcatenatedSequence(parent,other){this.parent=parent,this.other=other}function IndexedUniqueSequence(parent,keyFn){this.parent=parent,this.each=getEachForParent(parent),this.keyFn=keyFn}function getEachForParent(parent){return parent.length()<100?IndexedUniqueSequence.prototype.eachArrayCache:UniqueSequence.prototype.each}function ArrayWrapper(source){this.source=source}function MappedArrayWrapper(parent,mapFn){this.parent=parent,this.mapFn=mapFn}function FilteredArrayWrapper(parent,filterFn){this.parent=parent,this.filterFn=filterFn}function UniqueArrayWrapper(parent,keyFn){this.parent=parent,this.each=getEachForSource(parent.source),this.keyFn=keyFn}function getEachForSource(source){return source.length<40?UniqueArrayWrapper.prototype.eachNoCache:source.length<100?UniqueArrayWrapper.prototype.eachArrayCache:UniqueArrayWrapper.prototype.eachSetCache}function ConcatArrayWrapper(parent,other){this.parent=parent,this.other=other}function ObjectLikeSequence(){}function AssignSequence(parent,other){this.parent=parent,this.other=other}function DefaultsSequence(parent,defaults){this.parent=parent,this.defaults=defaults}function InvertedSequence(parent){this.parent=parent}function MergedSequence(parent,others,mergeFn){this.parent=parent,this.others=others,this.mergeFn=mergeFn}function mergeObjects(a,b){if("undefined"==typeof b)return a;if("object"!=typeof a||null===a||"object"!=typeof b||null===b)return b;var prop,merged={};for(prop in a)merged[prop]=mergeObjects(a[prop],b[prop]);for(prop in b)merged[prop]||(merged[prop]=b[prop]);return merged}function PickSequence(parent,properties){this.parent=parent,this.properties=properties}function OmitSequence(parent,properties){this.parent=parent,this.properties=properties}function ObjectWrapper(source){this.source=source}function StringLikeSequence(){}function CharIterator(source){this.source=Lazy(source),this.index=-1}function StringSegment(parent,start,stop){this.parent=parent,this.start=Math.max(0,start),this.stop=stop}function MappedStringLikeSequence(parent,mapFn){this.parent=parent,this.mapFn=mapFn}function ReversedStringLikeSequence(parent){this.parent=parent}function StringMatchSequence(source,pattern){this.source=source,this.pattern=pattern}function StringMatchIterator(source,pattern){this.source=source,this.pattern=cloneRegex(pattern)}function SplitStringSequence(source,pattern){this.source=source,this.pattern=pattern}function SplitWithRegExpIterator(source,pattern){this.source=source,this.pattern=cloneRegex(pattern)}function SplitWithStringIterator(source,delimiter){this.source=source,this.delimiter=delimiter}function StringWrapper(source){this.source=source}function GeneratedSequence(generatorFn,length){this.get=generatorFn,this.fixedLength=length}function GeneratedIterator(sequence){this.sequence=sequence,this.index=0,this.currentValue=null}function AsyncSequence(parent,interval){if(parent instanceof AsyncSequence)throw"Sequence is already asynchronous!";this.parent=parent,this.interval=interval,this.onNextCallback=getOnNextCallback(interval)}function AsyncHandle(interval){this.cancelCallback=getCancelCallback(interval)}function getOnNextCallback(interval){return"undefined"==typeof interval&&"function"==typeof setImmediate?setImmediate:(interval=interval||0,function(fn){return setTimeout(fn,interval)})}function getCancelCallback(interval){return"undefined"==typeof interval&&"function"==typeof clearImmediate?clearImmediate:clearTimeout}function WatchedPropertySequence(object,propertyNames){this.listeners=[],propertyNames?propertyNames instanceof Array||(propertyNames=[propertyNames]):propertyNames=Lazy(object).keys().toArray();var listeners=this.listeners,index=0;Lazy(propertyNames).each(function(propertyName){var propertyValue=object[propertyName];Object.defineProperty(object,propertyName,{get:function(){return propertyValue},set:function(value){for(var i=listeners.length-1;i>=0;--i)listeners[i]({property:propertyName,value:value},index)===!1&&listeners.splice(i,1);propertyValue=value,++index}})})}function StreamLikeSequence(){}function SplitStreamSequence(parent,delimiter){this.parent=parent,this.delimiter=delimiter}function MatchedStreamSequence(parent,pattern){this.parent=parent,this.pattern=cloneRegex(pattern)}function createCallback(callback,defaultValue){switch(typeof callback){case"function":return callback;case"string":return function(e){return e[callback]};case"object":return function(e){return Lazy(callback).all(function(value,key){return e[key]===value})};case"undefined":return defaultValue?function(){return defaultValue}:Lazy.identity;default:throw"Don't know how to make a callback from a "+typeof callback+"!"}}function createSet(values){var set=new Set;return Lazy(values||[]).flatten().each(function(e){set.add(e)}),set}function compare(x,y,fn){return"function"==typeof fn?compare(fn(x),fn(y)):x===y?0:x>y?1:-1}function forEach(array,fn){for(var i=-1,len=array.length;++i<len;)if(fn(array[i],i)===!1)return!1;return!0}function getFirst(sequence){var result;return sequence.each(function(e){return result=e,!1}),result}function arrayContains(array,element){var i=-1,length=array.length;if(element!==element){for(;++i<length;)if(array[i]!==array[i])return!0;return!1}for(;++i<length;)if(array[i]===element)return!0;return!1}function arrayContainsBefore(array,element,index,keyFn){var i=-1;if(keyFn){for(keyFn=createCallback(keyFn);++i<index;)if(keyFn(array[i])===keyFn(element))return!0}else for(;++i<index;)if(array[i]===element)return!0;return!1}function swap(array,i,j){var temp=array[i];array[i]=array[j],array[j]=temp}function cloneRegex(pattern){return eval(""+pattern+(pattern.global?"":"g"))}function Set(){this.table={},this.objects=[]}function Queue(capacity){this.contents=new Array(capacity),this.start=0,this.count=0}function defineSequenceType(base,name,overrides){var ctor=function(){};ctor.prototype=new base;for(var override in overrides)ctor.prototype[override]=overrides[override];for(var factory=function(){var sequence=new ctor;return sequence.parent=this,sequence.init&&sequence.init.apply(sequence,arguments),sequence},methodNames="string"==typeof name?[name]:name,i=0;i<methodNames.length;++i)base.prototype[methodNames[i]]=factory;return ctor}Lazy.VERSION="0.3.2",Lazy.noop=function(){},Lazy.identity=function(x){return x},Lazy.strict=function(){function StrictLazy(source){if(null==source)throw"You cannot wrap null or undefined using Lazy.";if("number"==typeof source||"boolean"==typeof source)throw"You cannot wrap primitive values using Lazy.";return Lazy(source)}return Lazy(Lazy).each(function(property,name){StrictLazy[name]=property}),StrictLazy},Sequence.define=function(methodName,overrides){if(!overrides||!overrides.getIterator&&!overrides.each)throw"A custom sequence must implement *at least* getIterator or each!";return defineSequenceType(Sequence,methodName,overrides)},Sequence.prototype.size=function(){return this.getIndex().length()},Sequence.prototype.getIterator=function(){return new Iterator(this)},Sequence.prototype.root=function(){return this.parent.root()},Sequence.prototype.value=function(){return this.toArray()},Sequence.prototype.apply=function(source){var result,root=this.root(),previousSource=root.source;try{root.source=source,result=this.value()}finally{root.source=previousSource}return result},Iterator.prototype.current=function(){return this.cachedIndex&&this.cachedIndex.get(this.index)},Iterator.prototype.moveNext=function(){var cachedIndex=this.cachedIndex;return cachedIndex||(cachedIndex=this.cachedIndex=this.sequence.getIndex()),this.index>=cachedIndex.length()-1?!1:(++this.index,!0)},Sequence.prototype.toArray=function(){return this.reduce(function(arr,element){return arr.push(element),arr},[])},Sequence.prototype.getIndex=function(){return this.cachedIndex||(this.cachedIndex=new ArrayWrapper(this.toArray())),this.cachedIndex},Sequence.prototype.memoize=function(){return new MemoizedSequence(this)},Sequence.prototype.toObject=function(){return this.reduce(function(object,pair){return object[pair[0]]=pair[1],object},{})},Sequence.prototype.each=function(fn){for(var iterator=this.getIterator(),i=-1;iterator.moveNext();)if(fn(iterator.current(),++i)===!1)return!1;return!0},Sequence.prototype.forEach=function(fn){return this.each(fn)},Sequence.prototype.map=function(mapFn){return new MappedSequence(this,createCallback(mapFn))},Sequence.prototype.collect=function(mapFn){return this.map(mapFn)},MappedSequence.prototype=new Sequence,MappedSequence.prototype.getIterator=function(){return new MappingIterator(this.parent,this.mapFn)},MappedSequence.prototype.each=function(fn){var mapFn=this.mapFn;return this.parent.each(function(e,i){return fn(mapFn(e,i),i)})},MappingIterator.prototype.current=function(){return this.mapFn(this.iterator.current(),this.index)},MappingIterator.prototype.moveNext=function(){return this.iterator.moveNext()?(++this.index,!0):!1},Sequence.prototype.pluck=function(property){return this.map(property)},Sequence.prototype.invoke=function(methodName){return this.map(function(e){return e[methodName]()})},Sequence.prototype.filter=function(filterFn){return new FilteredSequence(this,createCallback(filterFn))},Sequence.prototype.select=function(filterFn){return this.filter(filterFn)},FilteredSequence.prototype=new Sequence,FilteredSequence.prototype.getIterator=function(){return new FilteringIterator(this.parent,this.filterFn)},FilteredSequence.prototype.each=function(fn){var filterFn=this.filterFn;return this.parent.each(function(e,i){return filterFn(e,i)?fn(e,i):void 0})},FilteredSequence.prototype.reverse=function(){return this.parent.reverse().filter(this.filterFn)},FilteringIterator.prototype.current=function(){return this.value},FilteringIterator.prototype.moveNext=function(){for(var value,iterator=this.iterator,filterFn=this.filterFn;iterator.moveNext();)if(value=iterator.current(),filterFn(value,this.index++))return this.value=value,!0;return this.value=void 0,!1},Sequence.prototype.reject=function(rejectFn){return rejectFn=createCallback(rejectFn),this.filter(function(e){return!rejectFn(e)})},Sequence.prototype.ofType=function(type){return this.filter(function(e){return typeof e===type})},Sequence.prototype.where=function(properties){return this.filter(properties)},Sequence.prototype.reverse=function(){return new ReversedSequence(this)},ReversedSequence.prototype=new Sequence,ReversedSequence.prototype.getIterator=function(){return new ReversedIterator(this.parent)},ReversedIterator.prototype.current=function(){return this.sequence.getIndex().get(this.index)},ReversedIterator.prototype.moveNext=function(){var indexed=this.sequence.getIndex(),length=indexed.length();return"undefined"==typeof this.index&&(this.index=length),--this.index>=0},Sequence.prototype.concat=function(var_args){return new ConcatenatedSequence(this,arraySlice.call(arguments,0))},ConcatenatedSequence.prototype=new Sequence,ConcatenatedSequence.prototype.each=function(fn){var done=!1,i=0;this.parent.each(function(e){return fn(e,i++)===!1?(done=!0,!1):void 0}),done||Lazy(this.arrays).flatten().each(function(e){return fn(e,i++)===!1?!1:void 0})},Sequence.prototype.first=function(count){return"undefined"==typeof count?getFirst(this):new TakeSequence(this,count)},Sequence.prototype.head=Sequence.prototype.take=function(count){return this.first(count)},TakeSequence.prototype=new Sequence,TakeSequence.prototype.getIterator=function(){return new TakeIterator(this.parent,this.count)},TakeSequence.prototype.each=function(fn){var count=this.count,i=0;this.parent.each(function(e){var result;return count>i&&(result=fn(e,i)),++i>=count?!1:result})},TakeIterator.prototype.current=function(){return this.iterator.current()},TakeIterator.prototype.moveNext=function(){return--this.count>=0&&this.iterator.moveNext()},Sequence.prototype.takeWhile=function(predicate){return new TakeWhileSequence(this,predicate)},TakeWhileSequence.prototype=new Sequence,TakeWhileSequence.prototype.each=function(fn){var predicate=this.predicate;this.parent.each(function(e){return predicate(e)&&fn(e)})},Sequence.prototype.initial=function(count){return"undefined"==typeof count&&(count=1),this.take(this.getIndex().length()-count)},Sequence.prototype.last=function(count){return"undefined"==typeof count?this.reverse().first():this.reverse().take(count).reverse()},Sequence.prototype.findWhere=function(properties){return this.where(properties).first()},Sequence.prototype.rest=function(count){return new DropSequence(this,count)},Sequence.prototype.skip=Sequence.prototype.tail=Sequence.prototype.drop=function(count){return this.rest(count)},DropSequence.prototype=new Sequence,DropSequence.prototype.each=function(fn){var count=this.count,dropped=0,i=0;this.parent.each(function(e){return dropped++<count?void 0:fn(e,i++)})},Sequence.prototype.dropWhile=function(predicate){return new DropWhileSequence(this,predicate)},Sequence.prototype.skipWhile=function(predicate){return this.dropWhile(predicate)},DropWhileSequence.prototype=new Sequence,DropWhileSequence.prototype.each=function(fn){var predicate=this.predicate,done=!1;this.parent.each(function(e){if(!done){if(predicate(e))return;done=!0}return fn(e)})},Sequence.prototype.sortBy=function(sortFn){return new SortedSequence(this,sortFn)},SortedSequence.prototype=new Sequence,SortedSequence.prototype.each=function(fn){var sortFn=createCallback(this.sortFn),sorted=this.parent.toArray();return sorted.sort(function(x,y){return compare(x,y,sortFn)}),forEach(sorted,fn)},Sequence.prototype.groupBy=function(keyFn){return new GroupedSequence(this,keyFn)},Sequence.prototype.countBy=function(keyFn){return new CountedSequence(this,keyFn)},Sequence.prototype.uniq=function(keyFn){return new UniqueSequence(this,keyFn)},Sequence.prototype.unique=function(keyFn){return this.uniq(keyFn)},UniqueSequence.prototype=new Sequence,UniqueSequence.prototype.each=function(fn){var cache=new Set,keyFn=this.keyFn,i=0;return keyFn?(keyFn=createCallback(keyFn),this.parent.each(function(e){return cache.add(keyFn(e))?fn(e,i++):void 0})):this.parent.each(function(e){return cache.add(e)?fn(e,i++):void 0})},Sequence.prototype.zip=function(var_args){return 1===arguments.length?new SimpleZippedSequence(this,var_args):new ZippedSequence(this,arraySlice.call(arguments,0))},ZippedSequence.prototype=new Sequence,ZippedSequence.prototype.each=function(fn){var arrays=this.arrays,i=0;this.parent.each(function(e){for(var group=[e],j=0;j<arrays.length;++j)arrays[j].length>i&&group.push(arrays[j][i]);return fn(group,i++)})},Sequence.prototype.shuffle=function(){return new ShuffledSequence(this)},ShuffledSequence.prototype=new Sequence,ShuffledSequence.prototype.each=function(fn){for(var shuffled=this.parent.toArray(),floor=Math.floor,random=Math.random,j=0,i=shuffled.length-1;i>0;--i)if(swap(shuffled,i,floor(random()*i)+1),fn(shuffled[i],j++)===!1)return;fn(shuffled[0],j)},Sequence.prototype.flatten=function(){return new FlattenedSequence(this)},FlattenedSequence.prototype=new Sequence,FlattenedSequence.prototype.each=function(fn){var index=0;return this.parent.each(function recurseVisitor(e){return e instanceof Array?forEach(e,recurseVisitor):e instanceof Sequence?e.each(recurseVisitor):fn(e,index++)})},Sequence.prototype.compact=function(){return this.filter(function(e){return!!e})},Sequence.prototype.without=function(var_args){return new WithoutSequence(this,arraySlice.call(arguments,0))},Sequence.prototype.difference=function(var_args){return this.without.apply(this,arguments)},WithoutSequence.prototype=new Sequence,WithoutSequence.prototype.each=function(fn){var set=createSet(this.values),i=0;return this.parent.each(function(e){return set.contains(e)?void 0:fn(e,i++)})},Sequence.prototype.union=function(var_args){return this.concat(var_args).uniq()},Sequence.prototype.intersection=function(var_args){return 1===arguments.length&&arguments[0]instanceof Array?new SimpleIntersectionSequence(this,var_args):new IntersectionSequence(this,arraySlice.call(arguments,0))},IntersectionSequence.prototype=new Sequence,IntersectionSequence.prototype.each=function(fn){var sets=Lazy(this.arrays).map(function(values){return new UniqueMemoizer(Lazy(values).getIterator())}),setIterator=new UniqueMemoizer(sets.getIterator()),i=0;return this.parent.each(function(e){var includedInAll=!0;return setIterator.each(function(set){return set.contains(e)?void 0:(includedInAll=!1,!1)}),includedInAll?fn(e,i++):void 0})},UniqueMemoizer.prototype.current=function(){return this.currentValue},UniqueMemoizer.prototype.moveNext=function(){for(var current,iterator=this.iterator,set=this.set,memo=this.memo;iterator.moveNext();)if(current=iterator.current(),set.add(current))return memo.push(current),this.currentValue=current,!0;return!1},UniqueMemoizer.prototype.each=function(fn){for(var memo=this.memo,length=memo.length,i=-1;++i<length;)if(fn(memo[i],i)===!1)return!1;for(;this.moveNext()&&fn(this.currentValue,i++)!==!1;);},UniqueMemoizer.prototype.contains=function(e){if(this.set.contains(e))return!0;for(;this.moveNext();)if(this.currentValue===e)return!0;return!1},Sequence.prototype.every=function(predicate){return predicate=createCallback(predicate),this.each(function(e,i){return!!predicate(e,i)})},Sequence.prototype.all=function(predicate){return this.every(predicate)},Sequence.prototype.some=function(predicate){predicate=createCallback(predicate,!0);var success=!1;return this.each(function(e){return predicate(e)?(success=!0,!1):void 0}),success},Sequence.prototype.any=function(predicate){return this.some(predicate)},Sequence.prototype.none=function(predicate){return!this.any(predicate)},Sequence.prototype.isEmpty=function(){return!this.any()},Sequence.prototype.indexOf=function(value){var foundIndex=-1;return this.each(function(e,i){return e===value?(foundIndex=i,!1):void 0}),foundIndex},Sequence.prototype.lastIndexOf=function(value){var index=this.reverse().indexOf(value);return-1!==index&&(index=this.getIndex().length()-index-1),index},Sequence.prototype.sortedIndex=function(value){for(var i,indexed=this.getIndex(),lower=0,upper=indexed.length();upper>lower;)i=lower+upper>>>1,-1===compare(indexed.get(i),value)?lower=i+1:upper=i;return lower},Sequence.prototype.contains=function(value){return-1!==this.indexOf(value)},Sequence.prototype.reduce=function(aggregator,memo){return arguments.length<2?this.tail().reduce(aggregator,this.head()):(this.each(function(e,i){memo=aggregator(memo,e,i)}),memo)},Sequence.prototype.inject=Sequence.prototype.foldl=function(aggregator,memo){return this.reduce(aggregator,memo)},Sequence.prototype.reduceRight=function(aggregator,memo){if(arguments.length<2)return this.initial(1).reduceRight(aggregator,this.last());var i=this.getIndex().length()-1;return this.reverse().reduce(function(m,e){return aggregator(m,e,i--)},memo)},Sequence.prototype.foldr=function(aggregator,memo){return this.reduceRight(aggregator,memo)},Sequence.prototype.consecutive=function(count){var queue=new Queue(count),segments=this.map(function(element){return queue.add(element).count===count?queue.toArray():void 0});return segments.compact()},Sequence.prototype.chunk=function(size){if(1>size)throw"You must specify a positive chunk size.";return new ChunkedSequence(this,size)},ChunkedSequence.prototype=new Sequence,ChunkedSequence.prototype.getIterator=function(){return new ChunkedIterator(this.parent,this.chunkSize)},ChunkedIterator.prototype.current=function(){return this.currentChunk},ChunkedIterator.prototype.moveNext=function(){for(var iterator=this.iterator,chunkSize=this.size,chunk=[];chunk.length<chunkSize&&iterator.moveNext();)chunk.push(iterator.current());return 0===chunk.length?!1:(this.currentChunk=chunk,!0)},Sequence.prototype.tap=function(callback){return new TappedSequence(this,callback)},TappedSequence.prototype=new Sequence,TappedSequence.prototype.each=function(fn){var callback=this.callback;return this.parent.each(function(e,i){return callback(e,i),fn(e,i)})},Sequence.prototype.find=function(predicate){return this.filter(predicate).first()},Sequence.prototype.detect=function(predicate){return this.find(predicate)},Sequence.prototype.min=function(valueFn){return"undefined"!=typeof valueFn?this.minBy(valueFn):this.reduce(function(x,y){return x>y?y:x},1/0)},Sequence.prototype.minBy=function(valueFn){return valueFn=createCallback(valueFn),this.reduce(function(x,y){return valueFn(y)<valueFn(x)?y:x})},Sequence.prototype.max=function(valueFn){return"undefined"!=typeof valueFn?this.maxBy(valueFn):this.reduce(function(x,y){return y>x?y:x},-(1/0))},Sequence.prototype.maxBy=function(valueFn){return valueFn=createCallback(valueFn),this.reduce(function(x,y){return valueFn(y)>valueFn(x)?y:x})},Sequence.prototype.sum=function(valueFn){return"undefined"!=typeof valueFn?this.sumBy(valueFn):this.reduce(function(x,y){return x+y},0)},Sequence.prototype.sumBy=function(valueFn){return valueFn=createCallback(valueFn),this.reduce(function(x,y){return x+valueFn(y)},0)},Sequence.prototype.join=function(delimiter){return delimiter="string"==typeof delimiter?delimiter:",",this.reduce(function(str,e){return str.length>0&&(str+=delimiter),str+e},"")},Sequence.prototype.toString=function(delimiter){return this.join(delimiter)},Sequence.prototype.async=function(interval){return new AsyncSequence(this,interval)},SimpleIntersectionSequence.prototype=new Sequence,SimpleIntersectionSequence.prototype.eachMemoizerCache=function(fn){var iterator=new UniqueMemoizer(Lazy(this.array).getIterator()),i=0;return this.parent.each(function(e){return iterator.contains(e)?fn(e,i++):void 0})},SimpleIntersectionSequence.prototype.eachArrayCache=function(fn){var array=this.array,find=arrayContains,i=0;return this.parent.each(function(e){return find(array,e)?fn(e,i++):void 0})},SimpleZippedSequence.prototype=new Sequence,SimpleZippedSequence.prototype.each=function(fn){var array=this.array;return this.parent.each(function(e,i){return fn([e,array[i]],i)})},ArrayLikeSequence.prototype=new Sequence,ArrayLikeSequence.define=function(methodName,overrides){if(!overrides||"function"!=typeof overrides.get)throw"A custom array-like sequence must implement *at least* get!";return defineSequenceType(ArrayLikeSequence,methodName,overrides)},ArrayLikeSequence.prototype.get=function(i){return this.parent.get(i)},ArrayLikeSequence.prototype.length=function(){return this.parent.length()},ArrayLikeSequence.prototype.getIndex=function(){return this},ArrayLikeSequence.prototype.getIterator=function(){return new IndexedIterator(this)},IndexedIterator.prototype.current=function(){return this.sequence.get(this.index)},IndexedIterator.prototype.moveNext=function(){return this.index>=this.sequence.length()-1?!1:(++this.index,!0)},ArrayLikeSequence.prototype.each=function(fn){for(var length=this.length(),i=-1;++i<length;)if(fn(this.get(i),i)===!1)return!1;return!0},ArrayLikeSequence.prototype.pop=function(){return this.initial()},ArrayLikeSequence.prototype.shift=function(){return this.drop()},ArrayLikeSequence.prototype.slice=function(begin,end){var length=this.length();0>begin&&(begin=length+begin);var result=this.drop(begin);return"number"==typeof end&&(0>end&&(end=length+end),result=result.take(end-begin)),result},ArrayLikeSequence.prototype.map=function(mapFn){return new IndexedMappedSequence(this,createCallback(mapFn))},IndexedMappedSequence.prototype=new ArrayLikeSequence,IndexedMappedSequence.prototype.get=function(i){return 0>i||i>=this.parent.length()?void 0:this.mapFn(this.parent.get(i),i)},ArrayLikeSequence.prototype.filter=function(filterFn){return new IndexedFilteredSequence(this,createCallback(filterFn))},IndexedFilteredSequence.prototype=new FilteredSequence,IndexedFilteredSequence.prototype.each=function(fn){for(var e,parent=this.parent,filterFn=this.filterFn,length=this.parent.length(),i=-1;++i<length;)if(e=parent.get(i),filterFn(e,i)&&fn(e,i)===!1)return!1;return!0},ArrayLikeSequence.prototype.reverse=function(){return new IndexedReversedSequence(this)},IndexedReversedSequence.prototype=new ArrayLikeSequence,IndexedReversedSequence.prototype.get=function(i){return this.parent.get(this.length()-i-1)},ArrayLikeSequence.prototype.first=function(count){return"undefined"==typeof count?this.get(0):new IndexedTakeSequence(this,count)},IndexedTakeSequence.prototype=new ArrayLikeSequence,IndexedTakeSequence.prototype.length=function(){var parentLength=this.parent.length();return this.count<=parentLength?this.count:parentLength},ArrayLikeSequence.prototype.rest=function(count){return new IndexedDropSequence(this,count)},IndexedDropSequence.prototype=new ArrayLikeSequence,IndexedDropSequence.prototype.get=function(i){return this.parent.get(this.count+i)},IndexedDropSequence.prototype.length=function(){var parentLength=this.parent.length();return this.count<=parentLength?parentLength-this.count:0},ArrayLikeSequence.prototype.concat=function(var_args){return 1===arguments.length&&arguments[0]instanceof Array?new IndexedConcatenatedSequence(this,var_args):Sequence.prototype.concat.apply(this,arguments)},IndexedConcatenatedSequence.prototype=new ArrayLikeSequence,IndexedConcatenatedSequence.prototype.get=function(i){var parentLength=this.parent.length();return parentLength>i?this.parent.get(i):this.other[i-parentLength]},IndexedConcatenatedSequence.prototype.length=function(){return this.parent.length()+this.other.length},ArrayLikeSequence.prototype.uniq=function(keyFn){return new IndexedUniqueSequence(this,createCallback(keyFn))},IndexedUniqueSequence.prototype=new Sequence,IndexedUniqueSequence.prototype.eachArrayCache=function(fn){for(var key,value,parent=this.parent,keyFn=this.keyFn,length=parent.length(),cache=[],find=arrayContains,i=-1,j=0;++i<length;)if(value=parent.get(i),key=keyFn(value),!find(cache,key)&&(cache.push(key),fn(value,j++)===!1))return!1},IndexedUniqueSequence.prototype.eachSetCache=UniqueSequence.prototype.each,MemoizedSequence.prototype=new ArrayLikeSequence,MemoizedSequence.prototype.cache=function(){return this.cachedResult||(this.cachedResult=this.parent.toArray())},MemoizedSequence.prototype.get=function(i){return this.cache()[i]},MemoizedSequence.prototype.length=function(){return this.cache().length},MemoizedSequence.prototype.slice=function(begin,end){return this.cache().slice(begin,end)},MemoizedSequence.prototype.toArray=function(){return this.cache().slice(0)},ArrayWrapper.prototype=new ArrayLikeSequence,ArrayWrapper.prototype.root=function(){return this},ArrayWrapper.prototype.get=function(i){return this.source[i]},ArrayWrapper.prototype.length=function(){return this.source.length},ArrayWrapper.prototype.each=function(fn){return forEach(this.source,fn)},ArrayWrapper.prototype.map=ArrayWrapper.prototype.collect=function(mapFn){return new MappedArrayWrapper(this,createCallback(mapFn))},ArrayWrapper.prototype.filter=ArrayWrapper.prototype.select=function(filterFn){return new FilteredArrayWrapper(this,createCallback(filterFn))},ArrayWrapper.prototype.uniq=ArrayWrapper.prototype.unique=function(keyFn){return new UniqueArrayWrapper(this,keyFn)},ArrayWrapper.prototype.concat=function(var_args){return 1===arguments.length&&arguments[0]instanceof Array?new ConcatArrayWrapper(this,var_args):ArrayLikeSequence.prototype.concat.apply(this,arguments)},ArrayWrapper.prototype.toArray=function(){return this.source.slice(0)},MappedArrayWrapper.prototype=new ArrayLikeSequence,MappedArrayWrapper.prototype.get=function(i){var source=this.parent.source;return 0>i||i>=source.length?void 0:this.mapFn(source[i])},MappedArrayWrapper.prototype.length=function(){return this.parent.source.length},MappedArrayWrapper.prototype.each=function(fn){for(var source=this.parent.source,length=source.length,mapFn=this.mapFn,i=-1;++i<length;)if(fn(mapFn(source[i],i),i)===!1)return!1;return!0},FilteredArrayWrapper.prototype=new FilteredSequence,FilteredArrayWrapper.prototype.each=function(fn){for(var e,source=this.parent.source,filterFn=this.filterFn,length=source.length,i=-1;++i<length;)if(e=source[i],filterFn(e,i)&&fn(e,i)===!1)return!1;return!0},UniqueArrayWrapper.prototype=new Sequence,UniqueArrayWrapper.prototype.eachNoCache=function(fn){for(var value,source=this.parent.source,keyFn=this.keyFn,length=source.length,find=arrayContainsBefore,i=-1,k=0;++i<length;)if(value=source[i],!find(source,value,i,keyFn)&&fn(value,k++)===!1)return!1;return!0},UniqueArrayWrapper.prototype.eachArrayCache=function(fn){var key,value,source=this.parent.source,keyFn=this.keyFn,length=source.length,cache=[],find=arrayContains,i=-1,j=0;if(keyFn){for(keyFn=createCallback(keyFn);++i<length;)if(value=source[i],
key=keyFn(value),!find(cache,key)&&(cache.push(key),fn(value,j++)===!1))return!1}else for(;++i<length;)if(value=source[i],!find(cache,value)&&(cache.push(value),fn(value,j++)===!1))return!1;return!0},UniqueArrayWrapper.prototype.eachSetCache=UniqueSequence.prototype.each,ConcatArrayWrapper.prototype=new ArrayLikeSequence,ConcatArrayWrapper.prototype.get=function(i){var source=this.parent.source,sourceLength=source.length;return sourceLength>i?source[i]:this.other[i-sourceLength]},ConcatArrayWrapper.prototype.length=function(){return this.parent.source.length+this.other.length},ConcatArrayWrapper.prototype.each=function(fn){for(var source=this.parent.source,sourceLength=source.length,other=this.other,otherLength=other.length,i=0,j=-1;++j<sourceLength;)if(fn(source[j],i++)===!1)return!1;for(j=-1;++j<otherLength;)if(fn(other[j],i++)===!1)return!1;return!0},ObjectLikeSequence.prototype=new Sequence,ObjectLikeSequence.define=function(methodName,overrides){if(!overrides||"function"!=typeof overrides.each)throw"A custom object-like sequence must implement *at least* each!";return defineSequenceType(ObjectLikeSequence,methodName,overrides)},ObjectLikeSequence.prototype.value=function(){return this.toObject()},ObjectLikeSequence.prototype.get=function(key){var pair=this.pairs().find(function(pair){return pair[0]===key});return pair?pair[1]:void 0},ObjectLikeSequence.prototype.keys=function(){return this.map(function(v,k){return k})},ObjectLikeSequence.prototype.values=function(){return this.map(function(v,k){return v})},ObjectLikeSequence.prototype.async=function(){throw"An ObjectLikeSequence does not support asynchronous iteration."},ObjectLikeSequence.prototype.reverse=function(){return this},ObjectLikeSequence.prototype.assign=function(other){return new AssignSequence(this,other)},ObjectLikeSequence.prototype.extend=function(other){return this.assign(other)},AssignSequence.prototype=new ObjectLikeSequence,AssignSequence.prototype.get=function(key){return this.other[key]||this.parent.get(key)},AssignSequence.prototype.each=function(fn){var merged=new Set,done=!1;return Lazy(this.other).each(function(value,key){return fn(value,key)===!1?(done=!0,!1):void merged.add(key)}),done?void 0:this.parent.each(function(value,key){return merged.contains(key)||fn(value,key)!==!1?void 0:!1})},ObjectLikeSequence.prototype.defaults=function defaults(defaults){return new DefaultsSequence(this,defaults)},DefaultsSequence.prototype=new ObjectLikeSequence,DefaultsSequence.prototype.get=function(key){return this.parent.get(key)||this.defaults[key]},DefaultsSequence.prototype.each=function(fn){var merged=new Set,done=!1;this.parent.each(function(value,key){return fn(value,key)===!1?(done=!0,!1):void("undefined"!=typeof value&&merged.add(key))}),done||Lazy(this.defaults).each(function(value,key){return merged.contains(key)||fn(value,key)!==!1?void 0:!1})},ObjectLikeSequence.prototype.invert=function(){return new InvertedSequence(this)},InvertedSequence.prototype=new ObjectLikeSequence,InvertedSequence.prototype.each=function(fn){this.parent.each(function(value,key){return fn(key,value)})},ObjectLikeSequence.prototype.merge=function(var_args){var mergeFn=arguments.length>1&&"function"==typeof arguments[arguments.length-1]?arrayPop.call(arguments):null;return new MergedSequence(this,arraySlice.call(arguments,0),mergeFn)},MergedSequence.prototype=new ObjectLikeSequence,MergedSequence.prototype.each=function(fn){var others=this.others,mergeFn=this.mergeFn||mergeObjects,keys={},iteratedFullSource=this.parent.each(function(value,key){var merged=value;return forEach(others,function(other){key in other&&(merged=mergeFn(merged,other[key]))}),keys[key]=!0,fn(merged,key)});if(iteratedFullSource===!1)return!1;var remaining={};return forEach(others,function(other){for(var k in other)keys[k]||(remaining[k]=mergeFn(remaining[k],other[k]))}),Lazy(remaining).each(fn)},ObjectLikeSequence.prototype.functions=function(){return this.filter(function(v,k){return"function"==typeof v}).map(function(v,k){return k})},ObjectLikeSequence.prototype.methods=function(){return this.functions()},ObjectLikeSequence.prototype.pick=function(properties){return new PickSequence(this,properties)},PickSequence.prototype=new ObjectLikeSequence,PickSequence.prototype.get=function(key){return arrayContains(this.properties,key)?this.parent.get(key):void 0},PickSequence.prototype.each=function(fn){var inArray=arrayContains,properties=this.properties;return this.parent.each(function(value,key){return inArray(properties,key)?fn(value,key):void 0})},ObjectLikeSequence.prototype.omit=function(properties){return new OmitSequence(this,properties)},OmitSequence.prototype=new ObjectLikeSequence,OmitSequence.prototype.get=function(key){return arrayContains(this.properties,key)?void 0:this.parent.get(key)},OmitSequence.prototype.each=function(fn){var inArray=arrayContains,properties=this.properties;return this.parent.each(function(value,key){return inArray(properties,key)?void 0:fn(value,key)})},ObjectLikeSequence.prototype.pairs=function(){return this.map(function(v,k){return[k,v]})},ObjectLikeSequence.prototype.toArray=function(){return this.pairs().toArray()},ObjectLikeSequence.prototype.toObject=function(){return this.reduce(function(object,value,key){return object[key]=value,object},{})},GroupedSequence.prototype=new ObjectLikeSequence,GroupedSequence.prototype.each=function(fn){var keyFn=createCallback(this.keyFn),grouped={};this.parent.each(function(e){var key=keyFn(e);grouped[key]?grouped[key].push(e):grouped[key]=[e]});for(var key in grouped)if(fn(grouped[key],key)===!1)return!1;return!0},CountedSequence.prototype=new ObjectLikeSequence,CountedSequence.prototype.each=function(fn){var keyFn=createCallback(this.keyFn),counted={};this.parent.each(function(e){var key=keyFn(e);counted[key]?counted[key]+=1:counted[key]=1});for(var key in counted)if(fn(counted[key],key)===!1)return!1;return!0},ObjectLikeSequence.prototype.watch=function(propertyNames){throw"You can only call #watch on a directly wrapped object."},ObjectWrapper.prototype=new ObjectLikeSequence,ObjectWrapper.prototype.root=function(){return this},ObjectWrapper.prototype.get=function(key){return this.source[key]},ObjectWrapper.prototype.each=function(fn){var key,source=this.source;for(key in source)if(fn(source[key],key)===!1)return!1;return!0},StringLikeSequence.prototype=new ArrayLikeSequence,StringLikeSequence.define=function(methodName,overrides){if(!overrides||"function"!=typeof overrides.get)throw"A custom string-like sequence must implement *at least* get!";return defineSequenceType(StringLikeSequence,methodName,overrides)},StringLikeSequence.prototype.value=function(){return this.toString()},StringLikeSequence.prototype.getIterator=function(){return new CharIterator(this)},CharIterator.prototype.current=function(){return this.source.charAt(this.index)},CharIterator.prototype.moveNext=function(){return++this.index<this.source.length()},StringLikeSequence.prototype.charAt=function(i){return this.get(i)},StringLikeSequence.prototype.charCodeAt=function(i){var char=this.charAt(i);return char?char.charCodeAt(0):NaN},StringLikeSequence.prototype.substring=function(start,stop){return new StringSegment(this,start,stop)},StringSegment.prototype=new StringLikeSequence,StringSegment.prototype.get=function(i){return this.parent.get(i+this.start)},StringSegment.prototype.length=function(){return("number"==typeof this.stop?this.stop:this.parent.length())-this.start},StringLikeSequence.prototype.first=function(count){return"undefined"==typeof count?this.charAt(0):this.substring(0,count)},StringLikeSequence.prototype.last=function(count){return"undefined"==typeof count?this.charAt(this.length()-1):this.substring(this.length()-count)},StringLikeSequence.prototype.drop=function(count){return this.substring(count)},StringLikeSequence.prototype.indexOf=function(substring,startIndex){return this.toString().indexOf(substring,startIndex)},StringLikeSequence.prototype.lastIndexOf=function(substring,startIndex){return this.toString().lastIndexOf(substring,startIndex)},StringLikeSequence.prototype.contains=function(substring){return-1!==this.indexOf(substring)},StringLikeSequence.prototype.endsWith=function(suffix){return this.substring(this.length()-suffix.length).toString()===suffix},StringLikeSequence.prototype.startsWith=function(prefix){return this.substring(0,prefix.length).toString()===prefix},StringLikeSequence.prototype.toUpperCase=function(){return this.mapString(function(char){return char.toUpperCase()})},StringLikeSequence.prototype.toLowerCase=function(){return this.mapString(function(char){return char.toLowerCase()})},StringLikeSequence.prototype.mapString=function(mapFn){return new MappedStringLikeSequence(this,mapFn)},MappedStringLikeSequence.prototype=new StringLikeSequence,MappedStringLikeSequence.prototype.get=IndexedMappedSequence.prototype.get,MappedStringLikeSequence.prototype.length=IndexedMappedSequence.prototype.length,StringLikeSequence.prototype.reverse=function(){return new ReversedStringLikeSequence(this)},ReversedStringLikeSequence.prototype=new StringLikeSequence,ReversedStringLikeSequence.prototype.get=IndexedReversedSequence.prototype.get,ReversedStringLikeSequence.prototype.length=IndexedReversedSequence.prototype.length,StringLikeSequence.prototype.toString=function(){return this.join("")},StringLikeSequence.prototype.match=function(pattern){return new StringMatchSequence(this.source,pattern)},StringMatchSequence.prototype=new Sequence,StringMatchSequence.prototype.getIterator=function(){return new StringMatchIterator(this.source,this.pattern)},StringMatchIterator.prototype.current=function(){return this.match[0]},StringMatchIterator.prototype.moveNext=function(){return!!(this.match=this.pattern.exec(this.source))},StringLikeSequence.prototype.split=function(delimiter){return new SplitStringSequence(this.source,delimiter)},SplitStringSequence.prototype=new Sequence,SplitStringSequence.prototype.getIterator=function(){return this.pattern instanceof RegExp?""===this.pattern.source||"(?:)"===this.pattern.source?new CharIterator(this.source):new SplitWithRegExpIterator(this.source,this.pattern):""===this.pattern?new CharIterator(this.source):new SplitWithStringIterator(this.source,this.pattern)},SplitWithRegExpIterator.prototype.current=function(){return this.source.substring(this.start,this.end)},SplitWithRegExpIterator.prototype.moveNext=function(){if(!this.pattern)return!1;var match=this.pattern.exec(this.source);return match?(this.start=this.nextStart?this.nextStart:0,this.end=match.index,this.nextStart=match.index+match[0].length,!0):this.pattern?(this.start=this.nextStart,this.end=void 0,this.nextStart=void 0,this.pattern=void 0,!0):!1},SplitWithStringIterator.prototype.current=function(){return this.source.substring(this.leftIndex,this.rightIndex)},SplitWithStringIterator.prototype.moveNext=function(){return this.finished||(this.leftIndex="undefined"!=typeof this.leftIndex?this.rightIndex+this.delimiter.length:0,this.rightIndex=this.source.indexOf(this.delimiter,this.leftIndex)),-1===this.rightIndex?(this.finished=!0,this.rightIndex=void 0,!0):!this.finished},StringWrapper.prototype=new StringLikeSequence,StringWrapper.prototype.root=function(){return this},StringWrapper.prototype.get=function(i){return this.source.charAt(i)},StringWrapper.prototype.length=function(){return this.source.length},GeneratedSequence.prototype=new Sequence,GeneratedSequence.prototype.length=function(){return this.fixedLength},GeneratedSequence.prototype.each=function(fn){for(var generatorFn=this.get,length=this.fixedLength,i=0;"undefined"==typeof length||length>i;)if(fn(generatorFn(i++))===!1)return!1;return!0},GeneratedSequence.prototype.getIterator=function(){return new GeneratedIterator(this)},GeneratedIterator.prototype.current=function(){return this.currentValue},GeneratedIterator.prototype.moveNext=function(){var sequence=this.sequence;return"number"==typeof sequence.fixedLength&&this.index>=sequence.fixedLength?!1:(this.currentValue=sequence.get(this.index++),!0)},AsyncSequence.prototype=new Sequence,AsyncSequence.prototype.getIterator=function(){throw"An AsyncSequence does not support synchronous iteration."},AsyncSequence.prototype.each=function(fn){var iterator=this.parent.getIterator(),onNextCallback=this.onNextCallback,i=0,handle=new AsyncHandle(this.interval);return handle.id=onNextCallback(function iterate(){try{iterator.moveNext()&&fn(iterator.current(),i++)!==!1?handle.id=onNextCallback(iterate):handle.completeCallback()}catch(e){handle.errorCallback(e)}}),handle},AsyncHandle.prototype.cancel=function(){var cancelCallback=this.cancelCallback;this.id&&(cancelCallback(this.id),this.id=null)},AsyncHandle.prototype.onError=function(callback){this.errorCallback=callback},AsyncHandle.prototype.errorCallback=Lazy.noop,AsyncHandle.prototype.onComplete=function(callback){this.completeCallback=callback},AsyncHandle.prototype.completeCallback=Lazy.noop,AsyncSequence.prototype.reverse=function(){return this.parent.reverse().async()},AsyncSequence.prototype.reduce=function(aggregator,memo){var handle=this.each(function(e,i){memo="undefined"==typeof memo&&0===i?e:aggregator(memo,e,i)});return handle.then=handle.onComplete=function(callback){handle.completeCallback=function(){callback(memo)}},handle},AsyncSequence.prototype.find=function(predicate){var found,handle=this.each(function(e,i){return predicate(e,i)?(found=e,!1):void 0});return handle.then=handle.onComplete=function(callback){handle.completeCallback=function(){callback(found)}},handle},AsyncSequence.prototype.indexOf=function(value){var foundIndex=-1,handle=this.each(function(e,i){return e===value?(foundIndex=i,!1):void 0});return handle.then=handle.onComplete=function(callback){handle.completeCallback=function(){callback(foundIndex)}},handle},AsyncSequence.prototype.contains=function(value){var found=!1,handle=this.each(function(e){return e===value?(found=!0,!1):void 0});return handle.then=handle.onComplete=function(callback){handle.completeCallback=function(){callback(found)}},handle},AsyncSequence.prototype.async=function(){return this},ObjectWrapper.prototype.watch=function(propertyNames){return new WatchedPropertySequence(this.source,propertyNames)},WatchedPropertySequence.prototype=new AsyncSequence,WatchedPropertySequence.prototype.each=function(fn){this.listeners.push(fn)},StreamLikeSequence.prototype=new AsyncSequence,StreamLikeSequence.prototype.split=function(delimiter){return new SplitStreamSequence(this,delimiter)},SplitStreamSequence.prototype=new Sequence,SplitStreamSequence.prototype.each=function(fn){var delimiter=this.delimiter,done=!1,i=0;return this.parent.each(function(chunk){return Lazy(chunk).split(delimiter).each(function(piece){return fn(piece,i++)===!1?(done=!0,!1):void 0}),!done})},StreamLikeSequence.prototype.lines=function(){return this.split("\n")},StreamLikeSequence.prototype.match=function(pattern){return new MatchedStreamSequence(this,pattern)},MatchedStreamSequence.prototype=new AsyncSequence,MatchedStreamSequence.prototype.each=function(fn){var pattern=this.pattern,done=!1,i=0;return this.parent.each(function(chunk){return Lazy(chunk).match(pattern).each(function(match){return fn(match,i++)===!1?(done=!0,!1):void 0}),!done})},Lazy.createWrapper=function(initializer){var ctor=function(){this.listeners=[]};return ctor.prototype=new StreamLikeSequence,ctor.prototype.each=function(listener){this.listeners.push(listener)},ctor.prototype.emit=function(data){for(var listeners=this.listeners,len=listeners.length,i=len-1;i>=0;--i)listeners[i](data)===!1&&listeners.splice(i,1)},function(){var sequence=new ctor;return initializer.apply(sequence,arguments),sequence}},Lazy.generate=function(generatorFn,length){return new GeneratedSequence(generatorFn,length)},Lazy.range=function(){var start=arguments.length>1?arguments[0]:0,stop=arguments.length>1?arguments[1]:arguments[0],step=arguments.length>2?arguments[2]:1;return this.generate(function(i){return start+step*i}).take(Math.floor((stop-start)/step))},Lazy.repeat=function(value,count){return Lazy.generate(function(){return value},count)},Lazy.Sequence=Sequence,Lazy.ArrayLikeSequence=ArrayLikeSequence,Lazy.ObjectLikeSequence=ObjectLikeSequence,Lazy.StringLikeSequence=StringLikeSequence,Lazy.StreamLikeSequence=StreamLikeSequence,Lazy.GeneratedSequence=GeneratedSequence,Lazy.AsyncSequence=AsyncSequence,Lazy.AsyncHandle=AsyncHandle,Lazy.deprecate=function(message,fn){return function(){return fn.apply(this,arguments)}};var arrayPop=Array.prototype.pop,arraySlice=Array.prototype.slice;Set.prototype.add=function(value){var objects,table=this.table,type=typeof value;switch(type){case"number":case"boolean":case"undefined":return table[value]?!1:(table[value]=!0,!0);case"string":switch(value.charAt(0)){case"_":case"f":case"t":case"c":case"u":case"@":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"N":value="@"+value}return table[value]?!1:(table[value]=!0,!0);default:return objects=this.objects,arrayContains(objects,value)?!1:(objects.push(value),!0)}},Set.prototype.contains=function(value){var type=typeof value;switch(type){case"number":case"boolean":case"undefined":return!!this.table[value];case"string":switch(value.charAt(0)){case"_":case"f":case"t":case"c":case"u":case"@":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"N":value="@"+value}return!!this.table[value];default:return arrayContains(this.objects,value)}},Queue.prototype.add=function(element){var contents=this.contents,capacity=contents.length,start=this.start;return this.count===capacity?(contents[start]=element,this.start=(start+1)%capacity):contents[this.count++]=element,this},Queue.prototype.toArray=function(){var contents=this.contents,start=this.start,count=this.count,snapshot=contents.slice(start,start+count);return snapshot.length<count&&(snapshot=snapshot.concat(contents.slice(0,count-snapshot.length))),snapshot},"object"==typeof module&&module&&module.exports===context?module.exports=Lazy:context.Lazy=Lazy}(this),function(window,angular,undefined){"use strict";function isValidDottedPath(path){return null!=path&&""!==path&&"hasOwnProperty"!==path&&MEMBER_NAME_REGEX.test("."+path)}function lookupDottedPath(obj,path){if(!isValidDottedPath(path))throw $resourceMinErr("badmember",'Dotted member path "@{0}" is invalid.',path);for(var keys=path.split("."),i=0,ii=keys.length;ii>i&&obj!==undefined;i++){var key=keys[i];obj=null!==obj?obj[key]:undefined}return obj}function shallowClearAndCopy(src,dst){dst=dst||{},angular.forEach(dst,function(value,key){delete dst[key]});for(var key in src)!src.hasOwnProperty(key)||"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key]);return dst}var $resourceMinErr=angular.$$minErr("$resource"),MEMBER_NAME_REGEX=/^(\.[a-zA-Z_$][0-9a-zA-Z_$]*)+$/;angular.module("ngResource",["ng"]).factory("$resource",["$http","$q",function($http,$q){function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function Route(template,defaults){this.template=template,this.defaults=defaults||{},this.urlParams={}}function resourceFactory(url,paramDefaults,actions){function extractParams(data,actionParams){var ids={};return actionParams=extend({},paramDefaults,actionParams),forEach(actionParams,function(value,key){isFunction(value)&&(value=value()),ids[key]=value&&value.charAt&&"@"==value.charAt(0)?lookupDottedPath(data,value.substr(1)):value}),ids}function defaultResponseInterceptor(response){return response.resource}function Resource(value){shallowClearAndCopy(value||{},this)}var route=new Route(url);return actions=extend({},DEFAULT_ACTIONS,actions),forEach(actions,function(action,name){var hasBody=/^(POST|PUT|PATCH)$/i.test(action.method);Resource[name]=function(a1,a2,a3,a4){var data,success,error,params={};switch(arguments.length){case 4:error=a4,success=a3;case 3:case 2:if(!isFunction(a2)){params=a1,data=a2,success=a3;break}if(isFunction(a1)){success=a1,error=a2;break}success=a2,error=a3;case 1:isFunction(a1)?success=a1:hasBody?data=a1:params=a1;break;case 0:break;default:throw $resourceMinErr("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var isInstanceCall=this instanceof Resource,value=isInstanceCall?data:action.isArray?[]:new Resource(data),httpConfig={},responseInterceptor=action.interceptor&&action.interceptor.response||defaultResponseInterceptor,responseErrorInterceptor=action.interceptor&&action.interceptor.responseError||undefined;forEach(action,function(value,key){"params"!=key&&"isArray"!=key&&"interceptor"!=key&&(httpConfig[key]=copy(value))}),hasBody&&(httpConfig.data=data),route.setUrlParams(httpConfig,extend({},extractParams(data,action.params||{}),params),action.url);var promise=$http(httpConfig).then(function(response){var data=response.data,promise=value.$promise;if(data){if(angular.isArray(data)!==!!action.isArray)throw $resourceMinErr("badcfg","Error in resource configuration. Expected response to contain an {0} but got an {1}",action.isArray?"array":"object",angular.isArray(data)?"array":"object");action.isArray?(value.length=0,forEach(data,function(item){"object"==typeof item?value.push(new Resource(item)):value.push(item)})):(shallowClearAndCopy(data,value),value.$promise=promise)}return value.$resolved=!0,response.resource=value,response},function(response){return value.$resolved=!0,(error||noop)(response),$q.reject(response)});return promise=promise.then(function(response){var value=responseInterceptor(response);return(success||noop)(value,response.headers),value},responseErrorInterceptor),isInstanceCall?promise:(value.$promise=promise,value.$resolved=!1,value)},Resource.prototype["$"+name]=function(params,success,error){isFunction(params)&&(error=success,success=params,params={});var result=Resource[name].call(this,params,this,success,error);return result.$promise||result}}),Resource.bind=function(additionalParamDefaults){return resourceFactory(url,extend({},paramDefaults,additionalParamDefaults),actions)},Resource}var DEFAULT_ACTIONS={get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}},noop=angular.noop,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,isFunction=angular.isFunction;return Route.prototype={setUrlParams:function(config,params,actionUrl){var val,encodedVal,self=this,url=actionUrl||self.template,urlParams=self.urlParams={};forEach(url.split(/\W/),function(param){if("hasOwnProperty"===param)throw $resourceMinErr("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(param)&&param&&new RegExp("(^|[^\\\\]):"+param+"(\\W|$)").test(url)&&(urlParams[param]=!0)}),url=url.replace(/\\:/g,":"),params=params||{},forEach(self.urlParams,function(_,urlParam){val=params.hasOwnProperty(urlParam)?params[urlParam]:self.defaults[urlParam],angular.isDefined(val)&&null!==val?(encodedVal=encodeUriSegment(val),url=url.replace(new RegExp(":"+urlParam+"(\\W|$)","g"),function(match,p1){return encodedVal+p1})):url=url.replace(new RegExp("(/?):"+urlParam+"(\\W|$)","g"),function(match,leadingSlashes,tail){return"/"==tail.charAt(0)?tail:leadingSlashes+tail})}),url=url.replace(/\/+$/,"")||"/",url=url.replace(/\/\.(?=\w+($|\?))/,"."),config.url=url.replace(/\/\\\./,"/."),forEach(params,function(value,key){self.urlParams[key]||(config.params=config.params||{},config.params[key]=value)})}},resourceFactory}])}(window,window.angular),function(window,angular,undefined){"use strict";angular.module("ngCookies",["ng"]).factory("$cookies",["$rootScope","$browser",function($rootScope,$browser){function push(){var name,value,browserCookies,updated;for(name in lastCookies)isUndefined(cookies[name])&&$browser.cookies(name,undefined);for(name in cookies)value=cookies[name],angular.isString(value)||(value=""+value,cookies[name]=value),value!==lastCookies[name]&&($browser.cookies(name,value),updated=!0);if(updated){updated=!1,browserCookies=$browser.cookies();for(name in cookies)cookies[name]!==browserCookies[name]&&(isUndefined(browserCookies[name])?delete cookies[name]:cookies[name]=browserCookies[name],updated=!0)}}var lastBrowserCookies,cookies={},lastCookies={},runEval=!1,copy=angular.copy,isUndefined=angular.isUndefined;return $browser.addPollFn(function(){var currentCookies=$browser.cookies();lastBrowserCookies!=currentCookies&&(lastBrowserCookies=currentCookies,copy(currentCookies,lastCookies),copy(currentCookies,cookies),runEval&&$rootScope.$apply())})(),runEval=!0,$rootScope.$watch(push),cookies}]).factory("$cookieStore",["$cookies",function($cookies){return{get:function(key){var value=$cookies[key];return value?angular.fromJson(value):value},put:function(key,value){$cookies[key]=angular.toJson(value)},remove:function(key){delete $cookies[key]}}}])}(window,window.angular),function(window,angular,undefined){"use strict";function $SanitizeProvider(){this.$get=["$$sanitizeUri",function($$sanitizeUri){return function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf,function(uri,isImage){return!/^unsafe/.test($$sanitizeUri(uri,isImage))})),buf.join("")}}]}function sanitizeText(chars){var buf=[],writer=htmlSanitizeWriter(buf,angular.noop);return writer.chars(chars),buf.join("")}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function htmlParser(html,handler){function parseStartTag(tag,tagName,rest,unary){if(tagName=angular.lowercase(tagName),blockElements[tagName])for(;stack.last()&&inlineElements[stack.last()];)parseEndTag("",stack.last());optionalEndTagElements[tagName]&&stack.last()==tagName&&parseEndTag("",tagName),unary=voidElements[tagName]||!!unary,unary||stack.push(tagName);var attrs={};rest.replace(ATTR_REGEXP,function(match,name,doubleQuotedValue,singleQuotedValue,unquotedValue){var value=doubleQuotedValue||singleQuotedValue||unquotedValue||"";attrs[name]=decodeEntities(value)}),handler.start&&handler.start(tagName,attrs,unary)}function parseEndTag(tag,tagName){var i,pos=0;if(tagName=angular.lowercase(tagName))for(pos=stack.length-1;pos>=0&&stack[pos]!=tagName;pos--);if(pos>=0){for(i=stack.length-1;i>=pos;i--)handler.end&&handler.end(stack[i]);stack.length=pos}}"string"!=typeof html&&(html=null===html||"undefined"==typeof html?"":""+html);var index,chars,match,text,stack=[],last=html;for(stack.last=function(){return stack[stack.length-1]};html;){if(text="",chars=!0,stack.last()&&specialElements[stack.last()]?(html=html.replace(new RegExp("(.*)<\\s*\\/\\s*"+stack.last()+"[^>]*>","i"),function(all,text){return text=text.replace(COMMENT_REGEXP,"$1").replace(CDATA_REGEXP,"$1"),handler.chars&&handler.chars(decodeEntities(text)),""}),parseEndTag("",stack.last())):(0===html.indexOf("<!--")?(index=html.indexOf("--",4),index>=0&&html.lastIndexOf("-->",index)===index&&(handler.comment&&handler.comment(html.substring(4,index)),html=html.substring(index+3),chars=!1)):DOCTYPE_REGEXP.test(html)?(match=html.match(DOCTYPE_REGEXP),match&&(html=html.replace(match[0],""),chars=!1)):BEGING_END_TAGE_REGEXP.test(html)?(match=html.match(END_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(END_TAG_REGEXP,parseEndTag),chars=!1)):BEGIN_TAG_REGEXP.test(html)&&(match=html.match(START_TAG_REGEXP),match?(match[4]&&(html=html.substring(match[0].length),match[0].replace(START_TAG_REGEXP,parseStartTag)),chars=!1):(text+="<",html=html.substring(1))),chars&&(index=html.indexOf("<"),text+=0>index?html:html.substring(0,index),html=0>index?"":html.substring(index),handler.chars&&handler.chars(decodeEntities(text)))),html==last)throw $sanitizeMinErr("badparse","The sanitizer was unable to parse the following block of html: {0}",html);last=html}parseEndTag()}function decodeEntities(value){if(!value)return"";var parts=spaceRe.exec(value),spaceBefore=parts[1],spaceAfter=parts[3],content=parts[2];return content&&(hiddenPre.innerHTML=content.replace(/</g,"&lt;"),content="textContent"in hiddenPre?hiddenPre.textContent:hiddenPre.innerText),spaceBefore+content+spaceAfter}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,function(value){var hi=value.charCodeAt(0),low=value.charCodeAt(1);return"&#"+(1024*(hi-55296)+(low-56320)+65536)+";"}).replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriter(buf,uriValidator){var ignore=!1,out=angular.bind(buf,buf.push);return{start:function(tag,attrs,unary){tag=angular.lowercase(tag),!ignore&&specialElements[tag]&&(ignore=tag),ignore||validElements[tag]!==!0||(out("<"),out(tag),angular.forEach(attrs,function(value,key){var lkey=angular.lowercase(key),isImage="img"===tag&&"src"===lkey||"background"===lkey;validAttrs[lkey]!==!0||uriAttrs[lkey]===!0&&!uriValidator(value,isImage)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(unary?"/>":">"))},end:function(tag){tag=angular.lowercase(tag),ignore||validElements[tag]!==!0||(out("</"),out(tag),out(">")),tag==ignore&&(ignore=!1)},chars:function(chars){ignore||out(encodeEntities(chars))}}}var $sanitizeMinErr=angular.$$minErr("$sanitize"),START_TAG_REGEXP=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,END_TAG_REGEXP=/^<\/\s*([\w:-]+)[^>]*>/,ATTR_REGEXP=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,BEGIN_TAG_REGEXP=/^</,BEGING_END_TAGE_REGEXP=/^<\//,COMMENT_REGEXP=/<!--(.*?)-->/g,DOCTYPE_REGEXP=/<!DOCTYPE([^>]*?)>/i,CDATA_REGEXP=/<!\[CDATA\[(.*?)]]>/g,SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^\#-~| |!])/g,voidElements=makeMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=makeMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=makeMap("rp,rt"),optionalEndTagElements=angular.extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=angular.extend({},optionalEndTagBlockElements,makeMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),inlineElements=angular.extend({},optionalEndTagInlineElements,makeMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),specialElements=makeMap("script,style"),validElements=angular.extend({},voidElements,blockElements,inlineElements,optionalEndTagElements),uriAttrs=makeMap("background,cite,href,longdesc,src,usemap"),validAttrs=angular.extend({},uriAttrs,makeMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),hiddenPre=document.createElement("pre"),spaceRe=/^(\s*)([\s\S]*?)(\s*)$/;angular.module("ngSanitize",[]).provider("$sanitize",$SanitizeProvider),angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"]/,MAILTO_REGEXP=/^mailto:/;return function(text,target){function addText(text){text&&html.push(sanitizeText(text))}function addLink(url,text){html.push("<a "),angular.isDefined(target)&&(html.push('target="'),html.push(target),html.push('" ')),html.push('href="'),html.push(url),html.push('">'),addText(text),html.push("</a>")}if(!text)return text;for(var match,url,i,raw=text,html=[];match=raw.match(LINKY_URL_REGEXP);)url=match[0],
match[2]==match[3]&&(url="mailto:"+url),i=match.index,addText(raw.substr(0,i)),addLink(url,match[0].replace(MAILTO_REGEXP,"")),raw=raw.substring(i+match[0].length);return addText(raw),$sanitize(html.join(""))}}])}(window,window.angular),function(window,angular,undefined){"use strict";function $RouteProvider(){function inherit(parent,extra){return angular.extend(new(angular.extend(function(){},{prototype:parent})),extra)}function pathRegExp(path,opts){var insensitive=opts.caseInsensitiveMatch,ret={originalPath:path,regexp:path},keys=ret.keys=[];return path=path.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?\*])?/g,function(_,slash,key,option){var optional="?"===option?option:null,star="*"===option?option:null;return keys.push({name:key,optional:!!optional}),slash=slash||"",""+(optional?"":slash)+"(?:"+(optional?slash:"")+(star&&"(.+?)"||"([^/]+)")+(optional||"")+")"+(optional||"")}).replace(/([\/$\*])/g,"\\$1"),ret.regexp=new RegExp("^"+path+"$",insensitive?"i":""),ret}var routes={};this.when=function(path,route){if(routes[path]=angular.extend({reloadOnSearch:!0},route,path&&pathRegExp(path,route)),path){var redirectPath="/"==path[path.length-1]?path.substr(0,path.length-1):path+"/";routes[redirectPath]=angular.extend({redirectTo:path},pathRegExp(redirectPath,route))}return this},this.otherwise=function(params){return this.when(null,params),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function($rootScope,$location,$routeParams,$q,$injector,$http,$templateCache,$sce){function switchRouteMatcher(on,route){var keys=route.keys,params={};if(!route.regexp)return null;var m=route.regexp.exec(on);if(!m)return null;for(var i=1,len=m.length;len>i;++i){var key=keys[i-1],val=m[i];key&&val&&(params[key.name]=val)}return params}function updateRoute(){var next=parseRoute(),last=$route.current;next&&last&&next.$$route===last.$$route&&angular.equals(next.pathParams,last.pathParams)&&!next.reloadOnSearch&&!forceReload?(last.params=next.params,angular.copy(last.params,$routeParams),$rootScope.$broadcast("$routeUpdate",last)):(next||last)&&(forceReload=!1,$rootScope.$broadcast("$routeChangeStart",next,last),$route.current=next,next&&next.redirectTo&&(angular.isString(next.redirectTo)?$location.path(interpolate(next.redirectTo,next.params)).search(next.params).replace():$location.url(next.redirectTo(next.pathParams,$location.path(),$location.search())).replace()),$q.when(next).then(function(){if(next){var template,templateUrl,locals=angular.extend({},next.resolve);return angular.forEach(locals,function(value,key){locals[key]=angular.isString(value)?$injector.get(value):$injector.invoke(value)}),angular.isDefined(template=next.template)?angular.isFunction(template)&&(template=template(next.params)):angular.isDefined(templateUrl=next.templateUrl)&&(angular.isFunction(templateUrl)&&(templateUrl=templateUrl(next.params)),templateUrl=$sce.getTrustedResourceUrl(templateUrl),angular.isDefined(templateUrl)&&(next.loadedTemplateUrl=templateUrl,template=$http.get(templateUrl,{cache:$templateCache}).then(function(response){return response.data}))),angular.isDefined(template)&&(locals.$template=template),$q.all(locals)}}).then(function(locals){next==$route.current&&(next&&(next.locals=locals,angular.copy(next.params,$routeParams)),$rootScope.$broadcast("$routeChangeSuccess",next,last))},function(error){next==$route.current&&$rootScope.$broadcast("$routeChangeError",next,last,error)}))}function parseRoute(){var params,match;return angular.forEach(routes,function(route,path){!match&&(params=switchRouteMatcher($location.path(),route))&&(match=inherit(route,{params:angular.extend({},$location.search(),params),pathParams:params}),match.$$route=route)}),match||routes[null]&&inherit(routes[null],{params:{},pathParams:{}})}function interpolate(string,params){var result=[];return angular.forEach((string||"").split(":"),function(segment,i){if(0===i)result.push(segment);else{var segmentMatch=segment.match(/(\w+)(.*)/),key=segmentMatch[1];result.push(params[key]),result.push(segmentMatch[2]||""),delete params[key]}}),result.join("")}var forceReload=!1,$route={routes:routes,reload:function(){forceReload=!0,$rootScope.$evalAsync(updateRoute)}};return $rootScope.$on("$locationChangeSuccess",updateRoute),$route}]}function $RouteParamsProvider(){this.$get=function(){return{}}}function ngViewFactory($route,$anchorScroll,$animate){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(scope,$element,attr,ctrl,$transclude){function cleanupLastView(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement,function(){previousElement=null}),previousElement=currentElement,currentElement=null)}function update(){var locals=$route.current&&$route.current.locals,template=locals&&locals.$template;if(angular.isDefined(template)){var newScope=scope.$new(),current=$route.current,clone=$transclude(newScope,function(clone){$animate.enter(clone,null,currentElement||$element,function(){!angular.isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()}),cleanupLastView()});currentElement=clone,currentScope=current.scope=newScope,currentScope.$emit("$viewContentLoaded"),currentScope.$eval(onloadExp)}else cleanupLastView()}var currentScope,currentElement,previousElement,autoScrollExp=attr.autoscroll,onloadExp=attr.onload||"";scope.$on("$routeChangeSuccess",update),update()}}}function ngViewFillContentFactory($compile,$controller,$route){return{restrict:"ECA",priority:-400,link:function(scope,$element){var current=$route.current,locals=current.locals;$element.html(locals.$template);var link=$compile($element.contents());if(current.controller){locals.$scope=scope;var controller=$controller(current.controller,locals);current.controllerAs&&(scope[current.controllerAs]=controller),$element.data("$ngControllerController",controller),$element.children().data("$ngControllerController",controller)}link(scope)}}}var ngRouteModule=angular.module("ngRoute",["ng"]).provider("$route",$RouteProvider);ngRouteModule.provider("$routeParams",$RouteParamsProvider),ngRouteModule.directive("ngView",ngViewFactory),ngRouteModule.directive("ngView",ngViewFillContentFactory),ngViewFactory.$inject=["$route","$anchorScroll","$animate"],ngViewFillContentFactory.$inject=["$compile","$controller","$route"]}(window,window.angular);